<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <h1>
        student View room controller
    </h1>
    <div id="usernames"></div>
    <form action="/home/rooms/joinClassroom" method="post">
        <input type="text" name="roomCode" placeholder="Enter classroom code" required>
        <button type="submit">Join</button>
    </form>
    <a href="/home/rooms/ViewRoom"><span>查看房間</span></a>

    <a href="/logout"><span>登出</span></a>

</body>


<script src="/socket.io/socket.io.js"></script>
<script>
    const socket = io();
    const connect = 'connect';

    const usernameElement = document.getElementById('usernames');
    socket.on('connect', function () {
        console.log(connect);
    })

    socket.on('username', (name) => {
        if (name) {
            usernameElement.textContent = "使用者 :" + name;
        } else {
            usernameElement.textContent = '未登入 ';
        }
    });

    const urlParams = new URLSearchParams(window.location.search);
    const message = urlParams.get('message');

    if (message === 'unknow') {
        window.alert("找不到房間");
        window.location.href = "/home/rooms";
    }
    if (message === 'alreadyjoined') {
        window.alert("您已經加入過這個房間了");
        window.location.href = "/home/rooms"; 
    }
</script>

</html>